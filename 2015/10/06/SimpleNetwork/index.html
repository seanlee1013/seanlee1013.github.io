<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  
  <title>Simple Network | Song Li(Seanlee) Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Author: Song LiDownload Project AIMThis program is used to transform files from client to server, the server will run the received code and return the answer to the client. The client part and the ser">
<meta name="keywords" content="ADV Programming">
<meta property="og:type" content="article">
<meta property="og:title" content="Simple Network">
<meta property="og:url" content="http://blog.songli.us/2015/10/06/SimpleNetwork/index.html">
<meta property="og:site_name" content="Song Li(Seanlee) Blog">
<meta property="og:description" content="Author: Song LiDownload Project AIMThis program is used to transform files from client to server, the server will run the received code and return the answer to the client. The client part and the ser">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2018-10-02T16:57:05.671Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Simple Network">
<meta name="twitter:description" content="Author: Song LiDownload Project AIMThis program is used to transform files from client to server, the server will run the received code and return the answer to the client. The client part and the ser">
  
    <link rel="alternative" href="/atom.xml" title="Song Li(Seanlee) Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/image/favicon.png">
  
  
      <link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">
  
  
  
      <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
      <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">
  
  <link rel="stylesheet" href="/css/style.css">
  
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
  
    <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  
  <script src="//cdn.bootcss.com/jquery/1.9.1/jquery.min.js"></script>
  <script>
      var yiliaConfig = {
          fancybox: true,
          animate: true,
          isHome: false,
          isPost: true,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false,
      }
  </script>

  
      <script>
          yiliaConfig.rootUrl = "/";
      </script>
  

  

  
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="/image/avatar.jpg" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">Song Li</a></h1>
        </hgroup>

        
        <p class="header-subtitle">A Programmer&#39;s Life</p>
        
                


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>Menu</li>
                        <li>Tags</li>
                        
                        <li>Friends</li>
                        
                        
                        <li>About Me</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">home</a></li>
                        
                            <li><a href="/archives/">archives</a></li>
                        
                            <li><a href="/tags/">tags</a></li>
                        
                            <li><a href="/download/">download</a></li>
                        
                            <li><a href="/profile/">about</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <li id="Email"><a class="Email" target="_blank" href="/lisong1013@gmail.com" title="Email"></a></li>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/ADV-Programming/">ADV Programming</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Algorithm/">Algorithm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IS/">IS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IT/">IT</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Machine-Fingerprinting/">Machine Fingerprinting</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Notes/">Notes</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Piano-sheet/">Piano sheet</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Play/">Play</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/">Python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/leetcode/">leetcode</a></li></ul>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="https://hexo.io">Hexo</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="https://pages.github.com/">GitHub</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://moxfive.xyz/">MOxFIVE</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">Coding</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">Song Li</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="/image/avatar.jpg" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">Song Li</a></h1>
            </hgroup>
            
            <p class="header-subtitle">A Programmer&#39;s Life</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">home</a></li>
                
                    <li><a href="/archives/">archives</a></li>
                
                    <li><a href="/tags/">tags</a></li>
                
                    <li><a href="/download/">download</a></li>
                
                    <li><a href="/profile/">about</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <li id="Email"><a class="Email" target="_blank" href="/lisong1013@gmail.com" title="Email"></a></li>
                            
                        </ul>
            </nav>
        </header>                
    </div>
</nav>
      <div class="body-wrap"><article id="post-SimpleNetwork" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/06/SimpleNetwork/" class="article-date">
      <time datetime="2015-10-06T15:12:27.000Z" itemprop="datePublished">2015-10-06</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Simple Network
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        

        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ADV-Programming/">ADV Programming</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>Author: Song Li<br><a href="/download/sol315_HW3.zip">Download Project</a></p>
<h2 id="AIM"><a href="#AIM" class="headerlink" title="AIM"></a>AIM</h2><p>This program is used to transform files from client to server, the server will run the received code and return the answer to the client. The client part and the server part are combined to a single program. Using “fork()” function to make them work separately.</p>
<a id="more"></a>
<h2 id="USAGE"><a href="#USAGE" class="headerlink" title="USAGE"></a>USAGE</h2><p>Configure file:<br>The configure file is named “config”. The first line of the file is the number of the files that needed to format. The name of each file should be put line by line right after the first line. At the end of the file, input the argument to the “fmt” function. Here is the</p>
<h3 id="example"><a href="#example" class="headerlink" title="example"></a>example</h3><blockquote>
<p>2<br>Test<br>Test2<br>-w 10 -u</p>
</blockquote>
<h3 id="Arguments"><a href="#Arguments" class="headerlink" title="Arguments"></a>Arguments</h3><p>The IP address and the port number will be the arguments. Users can just input<br>the IP address and the port number just follow the “./combine”. Here is an example:</p>
<blockquote>
<p>./combine 127.0.0.1 9876</p>
</blockquote>
<h2 id="COMPILE"><a href="#COMPILE" class="headerlink" title="COMPILE"></a>COMPILE</h2><p>Type “make” to compile the source code.</p>
<h2 id="FILE-STRUCTURE"><a href="#FILE-STRUCTURE" class="headerlink" title="FILE STRUCTURE"></a>FILE STRUCTURE</h2><blockquote>
<p>fmt.c: the main code of this fmt.c<br>combine.c: the code of this program<br>makefile: the makefile document to compile the code<br>test: the first test file<br>test2: the second test file<br>config: the config file used by the program<br>Readme.pdf: this readme document</p>
</blockquote>
<h2 id="RESULT"><a href="#RESULT" class="headerlink" title="RESULT"></a>RESULT</h2><p>This program will have two processes, the files will be read from the client part and be sent to the server part. The server part will then receive these files, store them to the “./s_temp” folder, compile the fmt.c code, run it and return the answer to the client part.</p>
<h2 id="DESIGN"><a href="#DESIGN" class="headerlink" title="DESIGN"></a>DESIGN</h2><p>1) Connection refused: Since the server and client runs separately, when the client tries to connect the server, the server may not initiated yet. Every time when the client fails to connect the server, it will try to reconnect 3 seconds later again. If the client tries to reconnect 3 times and still not connected, it will give up and exit.<br>2) Avoid the same file name: As the client and the server are indeed one program, they work in a same directory. In order to avoid the change to this directory, all of the server’s work will be done in the “./s_temp/“ directory. Files received will be storied in “./s_temp/“, and they will be compiled there, they will run there, and they will get the answer there. </p>
<p>here is the code:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;netinet/in.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BUFFER_SIZE 500</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> A_LEN 5</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FILE_NUM 2<span class="comment">// the number of the codes and makefile</span></span></span><br><span class="line"><span class="keyword">int</span> filenum = <span class="number">0</span>;<span class="comment">//the total number of files</span></span><br><span class="line"><span class="keyword">char</span> files[<span class="number">100</span>][<span class="number">100</span>] = &#123;<span class="string">"fmt.c"</span>, <span class="string">"makefile"</span>&#125;;<span class="comment">//files that should be transed</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">errorout</span><span class="params">(<span class="keyword">int</span> id)</span></span>&#123;<span class="comment">//error output function</span></span><br><span class="line">    <span class="keyword">if</span>(id &gt; <span class="number">0</span>) </span><br><span class="line">        perror(<span class="string">"ERROR FROM CLIENT"</span>);</span><br><span class="line">    <span class="keyword">else</span> perror(<span class="string">"ERROR FROM SERVER"</span>);</span><br><span class="line">    <span class="keyword">switch</span> (id)&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"Client socket initiate error\n"</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"Client connect failed\n"</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"File open error\n"</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"Config file is needed\n"</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">-1</span>:</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"Server socket initiate error\n"</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">-2</span>:</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"Server bind error\n"</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">-3</span>:</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"Client connect failed\n"</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * this function is used to output message</span></span><br><span class="line"><span class="comment"> * @param </span></span><br><span class="line"><span class="comment"> *      server: 0 for client, 1 for server</span></span><br><span class="line"><span class="comment"> *      msg: the message itself</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">outputmsg</span><span class="params">(<span class="keyword">int</span> server, <span class="keyword">char</span> *msg)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(server) <span class="built_in">printf</span>(<span class="string">"SERVER: "</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"CLIENT: "</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%s"</span>,msg);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * this function is used to send message</span></span><br><span class="line"><span class="comment"> * @param</span></span><br><span class="line"><span class="comment"> *      c_sock: the socket which the message will send to</span></span><br><span class="line"><span class="comment"> *      msg: the message</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sendmessage</span><span class="params">(<span class="keyword">int</span> c_sock, <span class="keyword">char</span> *msg)</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> buffer[BUFFER_SIZE] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="built_in">strcpy</span>(buffer, msg);</span><br><span class="line">    send(c_sock, buffer, BUFFER_SIZE - <span class="number">2</span>,<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * this function is used to send files</span></span><br><span class="line"><span class="comment"> * @param</span></span><br><span class="line"><span class="comment"> *      c_sock: the socket which the message will send to</span></span><br><span class="line"><span class="comment"> *      filename: the file name of the file that is needed to be sent</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sendfile</span><span class="params">(<span class="keyword">int</span> c_sock, <span class="keyword">char</span> *filename)</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> buffer[BUFFER_SIZE] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    FILE *fp = fopen(filename, <span class="string">"r"</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="literal">NULL</span> == fp)&#123;</span><br><span class="line">        errorout(<span class="number">3</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%s isn\'t exist\n"</span>,filename);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(fgets(buffer, BUFFER_SIZE - <span class="number">2</span>, fp) != <span class="literal">NULL</span>)&#123;<span class="comment">//get the file line by line and send it</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%s"</span>,buffer);</span><br><span class="line">        send(c_sock, buffer, BUFFER_SIZE - <span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * the main function of client part</span></span><br><span class="line"><span class="comment"> * @param</span></span><br><span class="line"><span class="comment"> *      args: the arguments that should be sent to the server</span></span><br><span class="line"><span class="comment"> *      addr: the address information of client</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">client</span><span class="params">(<span class="keyword">char</span> * args, struct sockaddr_in addr)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> sock,i;</span><br><span class="line">    <span class="keyword">int</span> len;</span><br><span class="line">    <span class="keyword">char</span> buffer[BUFFER_SIZE];</span><br><span class="line">    sock = socket(PF_INET, SOCK_STREAM, <span class="number">0</span>);<span class="comment">//use ipv4/tcp/ip to transform</span></span><br><span class="line">    <span class="keyword">if</span>(sock &lt; <span class="number">0</span>)&#123;<span class="comment">//fail to initiate the socket</span></span><br><span class="line">        errorout(<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>;i &lt; <span class="number">3</span>;++ i)&#123;<span class="comment">//if the client tries to connect the server failed, try three times in total</span></span><br><span class="line">        <span class="keyword">if</span>(connect(sock, (struct sockaddr *)&amp;addr, <span class="keyword">sizeof</span>(struct sockaddr)) &lt; <span class="number">0</span>)&#123;</span><br><span class="line">            errorout(<span class="number">2</span>);</span><br><span class="line">            <span class="keyword">if</span>(i == <span class="number">2</span>) &#123;<span class="comment">// three times later, the client part will exit</span></span><br><span class="line">                errorout(<span class="number">2</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="number">-2</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//try to connect to the server 3 seconds later</span></span><br><span class="line">            outputmsg(<span class="number">0</span>,<span class="string">"Try to reconnect 3 seconds later\n"</span>);</span><br><span class="line">            sleep(<span class="number">1</span>);</span><br><span class="line">            outputmsg(<span class="number">0</span>,<span class="string">"Try to reconnect 2 seconds later\n"</span>);</span><br><span class="line">            sleep(<span class="number">1</span>);</span><br><span class="line">            outputmsg(<span class="number">0</span>,<span class="string">"Try to reconnect 1 second later\n"</span>);</span><br><span class="line">            sleep(<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    outputmsg(<span class="number">0</span>,<span class="string">"Connected to the server\n"</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"__START__TRANSMISSION\n__START__FILELIST\n"</span>);<span class="comment">//output the names of files</span></span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>;i &lt; FILE_NUM;++ i) <span class="built_in">printf</span>(<span class="string">"%s\n"</span>,files[i]);</span><br><span class="line">    sendmessage(sock, <span class="string">"__START__"</span>);<span class="comment">//send the file list (config) to the server</span></span><br><span class="line">    sendmessage(sock,<span class="string">"config"</span>);</span><br><span class="line">    sendfile(sock, <span class="string">"config"</span>);</span><br><span class="line">    sendmessage(sock, <span class="string">"__END__"</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"__END__FILELIST\n"</span>);</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>;i &lt; FILE_NUM;++ i)&#123;<span class="comment">//output the names and send messages and files to server        sendmessage(sock, "__START__");//if the cil</span></span><br><span class="line">        sendmessage(sock, <span class="string">"__START__"</span>);<span class="comment">//if the client sends the "__START__" message, it means there will be a new file to send</span></span><br><span class="line">        sendmessage(sock, files[i]);<span class="comment">//send the name of the file</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"__START__%s\n"</span>,files[i]);</span><br><span class="line">        sendfile(sock, files[i]);<span class="comment">//send this file</span></span><br><span class="line">        sendmessage(sock, <span class="string">"__END__"</span>);<span class="comment">//if the client sends the "__END__", means it's the end of a file</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"__END__%s\n"</span>,files[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"__START__ARGs\n"</span>);</span><br><span class="line">    sendmessage(sock,<span class="string">"__ARGs__"</span>);<span class="comment">//if the client sends the "__ARGs__", means the next message will be the atgs</span></span><br><span class="line">    sendmessage(sock,args);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%s\n"</span>,args);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"__END__ARGs\n"</span>);</span><br><span class="line">    <span class="keyword">for</span>(i = FILE_NUM;i &lt; filenum;++ i)&#123;<span class="comment">//send the files which are needed to format</span></span><br><span class="line">        sendmessage(sock, <span class="string">"__START__"</span>);</span><br><span class="line">        sendmessage(sock, files[i]);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"__START__%s_TO_FORMAT\n"</span>,files[i]);</span><br><span class="line">        sendfile(sock, files[i]);</span><br><span class="line">        sendmessage(sock, <span class="string">"__END__"</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"__END__%s_TO_FORMAT\n"</span>,files[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    sendmessage(sock,<span class="string">"__TRANS END__"</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"__END__TRANSMISSION\n"</span>);</span><br><span class="line">    <span class="keyword">int</span> flag = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>((len = recv(sock, buffer, BUFFER_SIZE - <span class="number">2</span>, <span class="number">0</span>)) &gt; <span class="number">0</span>)&#123;<span class="comment">//recv the answer from server</span></span><br><span class="line">        <span class="keyword">if</span>(!flag) <span class="built_in">printf</span>(<span class="string">"__START__RESULT\n"</span>);<span class="comment">//before the first line of answer, print this. in order to avoid the other process distroy the output, this message should be printed after it recvs the answer</span></span><br><span class="line">        flag = <span class="number">1</span>;</span><br><span class="line">        buffer[len] = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%s"</span>,buffer);</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"__END__RESULT\n"</span>);</span><br><span class="line">    close(sock);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * this function is the main function of server part</span></span><br><span class="line"><span class="comment"> * @param addr: the address of the server</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * in order to avoid the same file name with the original filename,</span></span><br><span class="line"><span class="comment"> * the server part will work in the ./s_temp/ folder</span></span><br><span class="line"><span class="comment"> * the files recieved by the server will be stored in this folder</span></span><br><span class="line"><span class="comment"> * and the answer will also be generated there</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">server</span><span class="params">(struct sockaddr_in s_addr)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> s_sock,c_sock;<span class="comment">//means the server sockets and the client sockets</span></span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">char</span> args[BUFFER_SIZE];<span class="comment">//args means the arguments</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">c_addr</span>;</span></span><br><span class="line">    <span class="keyword">char</span> buffer[BUFFER_SIZE];</span><br><span class="line">    <span class="keyword">char</span> filename[<span class="number">100</span>] = &#123;<span class="string">"./s_temp/"</span>&#125;;<span class="comment">//the filename started with ./s_temp/</span></span><br><span class="line">    FILE *fp = <span class="literal">NULL</span>;</span><br><span class="line">    s_sock = socket(PF_INET, SOCK_STREAM, <span class="number">0</span>);<span class="comment">//init the socket</span></span><br><span class="line">    <span class="keyword">if</span>(s_sock &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        errorout(<span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//bind the socket with the ip address</span></span><br><span class="line">    <span class="keyword">if</span>(bind(s_sock, (struct sockaddr *)&amp;s_addr, <span class="keyword">sizeof</span>(struct sockaddr)) &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        errorout(<span class="number">-2</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    outputmsg(<span class="number">1</span>,<span class="string">"Server starts to listen\n"</span>);</span><br><span class="line">    listen(s_sock, A_LEN);<span class="comment">//listen to the rhythm of the falling client</span></span><br><span class="line">    outputmsg(<span class="number">1</span>,<span class="string">"A client tries to connect\n"</span>);<span class="comment">//telling me just what a waitting the server've been</span></span><br><span class="line">    <span class="keyword">int</span> addrlen;</span><br><span class="line">    c_sock = accept(s_sock, (struct sockaddr *)&amp;c_addr, &amp;addrlen);<span class="comment">//I wish that it would go and let a client connect me</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"SERVER: User %d connected\n"</span>,c_sock);<span class="comment">//and let users know again</span></span><br><span class="line">    <span class="keyword">if</span>(c_sock &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        errorout(<span class="number">-3</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> len = <span class="number">0</span>,f_num = <span class="number">0</span>;</span><br><span class="line">    system(<span class="string">"mkdir s_temp"</span>);</span><br><span class="line">    <span class="keyword">while</span>((len = recv(c_sock, buffer, BUFFER_SIZE - <span class="number">2</span>, <span class="number">0</span>)) &gt; <span class="number">0</span>)&#123;<span class="comment">//Now the messages i've received has been stored</span></span><br><span class="line">        buffer[len] = <span class="number">0</span>;<span class="comment">//Looking for a end of the line</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">strcmp</span>(buffer, <span class="string">"__START__"</span>) == <span class="number">0</span>) &#123;<span class="comment">//little does message know that when it means a new file</span></span><br><span class="line">            len = recv(c_sock, buffer, BUFFER_SIZE - <span class="number">2</span>, <span class="number">0</span>);<span class="comment">//Receive the name and open the file</span></span><br><span class="line">            buffer[len] = <span class="number">0</span>;</span><br><span class="line">            <span class="built_in">strcpy</span>(filename + <span class="number">9</span>, buffer);<span class="comment">//"+9 means the length of "./s_temp/" after this, the filename will be "./s_temp/buffer". "</span></span><br><span class="line">            fp = fopen(filename,<span class="string">"w"</span>);<span class="comment">//"the file will be stored in the ./s_temp/"</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">strcmp</span>(buffer, <span class="string">"__END__"</span>) == <span class="number">0</span>)&#123;<span class="comment">//Client please tell me now does this a file's end</span></span><br><span class="line">            fclose(fp);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">strcmp</span>(buffer, <span class="string">"__TRANS END__"</span>) == <span class="number">0</span>) <span class="keyword">break</span>;<span class="comment">//For this is the end of the trans precess</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">strcmp</span>(buffer, <span class="string">"__ARGs__"</span>) == <span class="number">0</span>)&#123;<span class="comment">//I can't work fine when the arguement's somewhere far away</span></span><br><span class="line">            len = recv(c_sock, args, BUFFER_SIZE - <span class="number">2</span>, <span class="number">0</span>);<span class="comment">//receive the args of the fmt</span></span><br><span class="line">            args[len] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(fp) <span class="built_in">fputs</span>(buffer, fp);<span class="comment">//output the things into a file</span></span><br><span class="line">        <span class="keyword">if</span>(!fp) <span class="built_in">printf</span>(<span class="string">"%s"</span>,buffer);</span><br><span class="line">    &#125;</span><br><span class="line">    outputmsg(<span class="number">1</span>,<span class="string">"Output from server to handle files\n"</span>);</span><br><span class="line">    system(<span class="string">"make task1"</span>);<span class="comment">//gcc combine.c -o combine</span></span><br><span class="line">    len = <span class="number">13</span>;</span><br><span class="line">    <span class="comment">//the run fmt command will be generated here</span></span><br><span class="line">    <span class="built_in">strcpy</span>(buffer, <span class="string">"./s_temp/fmt "</span>);<span class="comment">//starts with this</span></span><br><span class="line">    <span class="built_in">strcpy</span>(buffer + <span class="number">13</span>, args);<span class="comment">//13 means the length of "./s_temp/fmt", the args will be copyed after this</span></span><br><span class="line">    len += <span class="built_in">strlen</span>(args);<span class="comment">//len += length of args</span></span><br><span class="line">    <span class="keyword">for</span>(i = FILE_NUM;i &lt; filenum;++ i)&#123;</span><br><span class="line">        <span class="built_in">strcpy</span>(buffer + len, <span class="string">"./s_temp/"</span>);<span class="comment">//after the args, the files which needs to format will be appended one by one, before every file, we will add "./s_temp/" </span></span><br><span class="line">        len += <span class="number">9</span>;</span><br><span class="line">        <span class="built_in">strcpy</span>(buffer + len, files[i]);</span><br><span class="line">        len += <span class="built_in">strlen</span>(files[i]);</span><br><span class="line">        buffer[len ++] = <span class="string">' '</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">strcpy</span>(buffer + len, <span class="string">" &gt; ./s_temp/output"</span>);<span class="comment">//adds the output</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"args=%s\n"</span>,buffer);<span class="comment">//output the command</span></span><br><span class="line">    system(buffer);<span class="comment">//run the command</span></span><br><span class="line">    outputmsg(<span class="number">1</span>,<span class="string">"Server output finished\n\n"</span>);</span><br><span class="line"></span><br><span class="line">    sendfile(c_sock, <span class="string">"./s_temp/output"</span>);<span class="comment">//send the answer back to the client</span></span><br><span class="line">    close(c_sock);</span><br><span class="line">    close(s_sock);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;    </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span>* argv[])</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> c_sock,i,len = <span class="number">0</span>;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">addr</span>;</span></span><br><span class="line">    <span class="keyword">char</span> buffer[<span class="number">200</span>];</span><br><span class="line">    <span class="keyword">char</span> args[<span class="number">1000</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">char</span> *IP = <span class="string">"127.0.0.1"</span>;<span class="comment">//the init IP</span></span><br><span class="line">    <span class="keyword">int</span> port = <span class="number">9585</span>;</span><br><span class="line">    FILE *fp = fopen(<span class="string">"./config"</span>,<span class="string">"r"</span>);<span class="comment">//read the config file</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="literal">NULL</span> == fp)&#123;</span><br><span class="line">        errorout(<span class="number">4</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125; </span><br><span class="line">    fgets(buffer, BUFFER_SIZE - <span class="number">2</span>, fp);</span><br><span class="line">    filenum = atoi(buffer);<span class="comment">//the first line will be the number of files</span></span><br><span class="line">    filenum += FILE_NUM;<span class="comment">//FILE_NUM means the number of code files</span></span><br><span class="line">    <span class="keyword">for</span>(i = FILE_NUM;i &lt; filenum;++ i)&#123;<span class="comment">//read the file names from config </span></span><br><span class="line">        fgets(files[i], <span class="number">100</span>, fp);</span><br><span class="line">        files[i][<span class="built_in">strlen</span>(files[i]) - <span class="number">1</span>] = <span class="number">0</span>;<span class="comment">//remove the '\n' after each filename</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//if the arguments exist, replace the IP and port address</span></span><br><span class="line">    <span class="keyword">if</span>(argc &gt; <span class="number">1</span>) IP = argv[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">if</span>(argc &gt; <span class="number">2</span>) port = atoi(argv[<span class="number">2</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"IP: %s\n"</span>,IP);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"port: %d\n"</span>,port);</span><br><span class="line"></span><br><span class="line">    fgets(buffer,<span class="number">100</span>, fp);<span class="comment">// get the argument of the fmt from the last line of the config</span></span><br><span class="line">    buffer[<span class="built_in">strlen</span>(buffer) - <span class="number">1</span>] = <span class="string">' '</span>;</span><br><span class="line">    addr.sin_family = AF_INET;<span class="comment">//init the address information of client and server</span></span><br><span class="line">    addr.sin_addr.s_addr = inet_addr(IP);</span><br><span class="line">    addr.sin_port = htons(port);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> id = fork();</span><br><span class="line">    <span class="keyword">if</span>(!id) client(buffer, addr);<span class="comment">//the subprocess will take the client part</span></span><br><span class="line">    <span class="keyword">else</span> server(addr);<span class="comment">//the main process will work as the server part</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>Title:</span><a href="/2015/10/06/SimpleNetwork/">Simple Network</a></p>
        <p><span>Author:</span><a href="/" title="Back to Homepage">Song Li</a></p>
        <p><span>Created:</span>2015-10-06, 11:12:27</p>
        <p><span>Updated:</span>2018-10-02, 12:57:05</p>
        <p>
            <span>Full URL:</span><a class="post-url" href="/2015/10/06/SimpleNetwork/" title="Simple Network">http://blog.songli.us/2015/10/06/SimpleNetwork/</a>
            <span class="copy-path" data-clipboard-text="From http://blog.songli.us/2015/10/06/SimpleNetwork/　　By Song Li" title="Copy Article&#39;s Link &amp; Author"><i class="fa fa-clipboard"></i></span>
            <script src="/js/clipboard.min.js"></script>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>License:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="CC BY-NC-SA 4.0 International" target = "_blank">"CC BY-NC-SA 4.0"</a> Keep Link &amp; Author if Distribute.
        </p>
    </div>



    <nav id="article-nav">
        
            <div id="article-nav-newer" class="article-nav-title">
                <a href="/2015/10/07/Matrixinvert/">
                    Matrix invert
                </a>
            </div>
        
        
            <div id="article-nav-older" class="article-nav-title">
                <a href="/2015/10/05/Myfmt/">
                    Myfmt
                </a>
            </div>
        
    </nav>

  
</article>

    <div id="toc" class="toc-article">
    <strong class="toc-title">Contents</strong>
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#AIM"><span class="toc-number">1.</span> <span class="toc-text">AIM</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#USAGE"><span class="toc-number">2.</span> <span class="toc-text">USAGE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#example"><span class="toc-number">2.1.</span> <span class="toc-text">example</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Arguments"><span class="toc-number">2.2.</span> <span class="toc-text">Arguments</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#COMPILE"><span class="toc-number">3.</span> <span class="toc-text">COMPILE</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FILE-STRUCTURE"><span class="toc-number">4.</span> <span class="toc-text">FILE STRUCTURE</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RESULT"><span class="toc-number">5.</span> <span class="toc-text">RESULT</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DESIGN"><span class="toc-number">6.</span> <span class="toc-text">DESIGN</span></a></li></ol>
</div>
<style>
    .left-col .switch-btn {
        display: none;
    }
    .left-col .switch-area {
        display: none;
    }
</style>

<input type="button" id="tocButton" value="Hide"  title="Show or Hide Table of Contents">
<script>
    var valueHide = "Hide";
    var valueShow = "Show";

    if ($(".left-col").is(":hidden")) {
        $("#tocButton").attr("value", valueShow);
    }

    $("#tocButton").click(function() {
        if ($("#toc").is(":hidden")) {
            $("#tocButton").attr("value", valueHide);
            $("#toc").slideDown(320);
            $(".switch-btn, .switch-area").fadeOut(300);
        }
        else {
            $("#tocButton").attr("value", valueShow);
            $("#toc").slideUp(350);
            $(".switch-btn, .switch-area").fadeIn(500);
        }
    })

    if ($(".toc").length < 1) {
        $("#toc, #tocButton").hide();
        $(".switch-btn, .switch-area").show();
    }
</script>





    
<div class="share">
    
        <div class="bdsharebuttonbox">
            <li id="bds_twi"><a href="#" class="bds_twi" data-cmd="twi" title="分享到推特"></a></li>
            <li id="bds_tsina"><a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a></li>
            <li id="bds_sqq"><a href="#" class="bds_sqq" data-cmd="sqq" title="分享给 QQ 好友"></a></li>
            <li id="bds_copy"><a href="#" class="bds_copy" data-cmd="copy" title="复制网址"></a></li>
            <li id="bds_mail"><a href="#" class="bds_mail" data-cmd="mail" title="通过邮件分享"></a></li>
            <li id="bds_weixin"><a href="#" class="bds_weixin" data-cmd="weixin" title="生成文章二维码"></a></li>
            <li id="bds_more"><a href="#" class="bds_more" data-cmd="more"></i></a></li>
        </div>
        <script>
            window._bd_share_config={
                "common":{"bdSnsKey":{},"bdText":"Simple Network　| Song Li(Seanlee) Blog　","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
        </script>
    

    
</div>







    
      <div class="duoshuo" id="comments">
    <!-- 多说评论框 start -->
    <div class="ds-thread" data-thread-key="2015/10/06/SimpleNetwork/" data-title="Simple Network" data-url="http://blog.songli.us/2015/10/06/SimpleNetwork/"></div>
    <!-- 多说评论框 end -->
    <!-- 多说公共JS代码 start (一个网页只需插入一次) -->
    <script type="text/javascript">
    var duoshuoQuery = {short_name:"songlius"};
    (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0] 
         || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
    </script>
    <!-- 多说公共JS代码 end -->
</div>

    




    <div class="scroll" id="post-nav-button">
        
            <a href="/2015/10/07/Matrixinvert/" title="Pre: Matrix invert">
                <i class="fa fa-angle-left"></i>
            </a>
        

        <a title="Mini Archives"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>

        
            <a href="/2015/10/05/Myfmt/" title="Next: Myfmt">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>

    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2016/06/15/convert-sorted-list-to-binary-search-tree/">convert sorted list to binary search tree</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/06/all-in-one-figure/">all in one figure</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/02/With-or-Without-Antialiasing/">With or Without Antialiasing</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/12/Gradient-Experiment-about-textures/">Gradient Experiment about textures</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/26/2016-4-26/">2016_4_26</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/24/Get-Edge-And-Subtract/">Get Edge And Subtract</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/17/Try-to-use-Alpha/">Try to use Alpha</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/26/Feb2528/">Feb25-28</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/11/02/PianosheetofDeborahsTheme/">Piano sheet of Deborah's Theme</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/10/26/leetcodeMissingNumber/">leetcode Missing Number</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/10/26/leetcodeUglyNumberII/">leetcode Ugly Number II</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/10/21/TowerofHanoi/">Tower of Hanoi</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/10/20/HeapinsertionanddeletioninC/">Heap insertion and deletion in C</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/10/20/verybasichashtable/">Very basic hashtable</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/10/17/Quicksort/">Quicksort</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/10/17/Heapsort/">Heapsort</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/10/17/DistanceCalculatorGUI/">Distance Calculator GUI</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/10/16/SortListusemergesort/">Sort List use merge sort</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/10/07/Matrixinvert/">Matrix invert</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/10/06/SimpleNetwork/">Simple Network</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/10/05/Myfmt/">Myfmt</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/06/07/MaximalSquare/">Maximal Square</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/06/07/CountCompleteTreeNodes/">Count Complete Tree Nodes</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/05/31/U6dd8U5b9dU7a0bU5e8fU5458U7684U7ecfU5386/">淘宝程序员的经历</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/04/05/U6700U5c0fU5272/">最小割</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/03/23/U5230U53d1U7ebfU8bbeU8ba1U9057U4f20U7b97U6cd5/">到发线设计遗传算法</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/03/06/2048/">2048</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/03/05/Stackoverflow/">Stackoverflow</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/02/23/U8681U7fa4U7b97U6cd5U53caU5176U5728U5217U8f66U89e3U4f53U987aU5e8fU7f16U6392U7684U5e94U7528/">蚁群算法及其在列车解体顺序编排的应用</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/02/09/IRST/">IRST</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/02/03/Minimumdominatingset/">Minimum Dominating Set</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/12/13/ab/">a+b</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/11/01/U79cb/">秋</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/10/31/exeprogram/">exe程序捆绑运行的设计实现</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/10/27/U6495U626fU81eaU5df1/">撕扯自己</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/02/06/U796dU5960/">祭奠</a></li></ul>




    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2018 Song Li
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="A fast, simple &amp; powerful blog framework">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="Another simple and elegant theme for Hexo">Yelee</a> by MOxFIVE
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" >Site Visitors: 
                            <span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>, </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit">Page Hits: 
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    
<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.1.22/require.min.js"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 5;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>


<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-74687031-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->



    <script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<div class="scroll" id="scroll">
    <a href="#" title="Back to Top"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" title="Comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="Go to Bottom"><i class="fa fa-arrow-down"></i></a>
</div>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>